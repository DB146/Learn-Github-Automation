name: Generate Keystore

on: workflow_dispatch

jobs:
  generate-key:
    runs-on: ubuntu-latest
    steps:
      - name: Generate Keystore
        run: |
          echo "ðŸ” Generating Keystore..."
          
          # Generate a standard Android signing key
          keytool -genkeypair -v \
            -keystore revanced.keystore \
            -alias revanced \
            -keyalg RSA \
            -keysize 2048 \
            -validity 10000 \
            -storepass password123 \
            -keypass password123 \
            -dname "CN=ReVanced, OU=Personal, O=Personal, L=Unknown, S=Unknown, C=Unknown"
          
          # Convert to Base64 (single line)
          BASE64_KEY=$(base64 -w 0 revanced.keystore)
          
          # Output to the GitHub Summary Page
          echo "## ðŸ”‘ Your New Keystore" >> $GITHUB_STEP_SUMMARY
          echo "Go to **Settings > Secrets and variables > Actions** and add these:" >> $GITHUB_STEP_SUMMARY
          
          echo "### 1. Secret Name: \`KEYSTORE_FILE\`" >> $GITHUB_STEP_SUMMARY
          echo "Value (Copy the long string below):" >> $GITHUB_STEP_SUMMARY
          echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
          echo "$BASE64_KEY" >> $GITHUB_STEP_SUMMARY
          echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
          
          echo "### 2. Secret Name: \`KEYSTORE_PASSWORD\`" >> $GITHUB_STEP_SUMMARY
          echo "Value: \`password123\`" >> $GITHUB_STEP_SUMMARY
          
          echo "### 3. Secret Name: \`KEYSTORE_ALIAS\`" >> $GITHUB_STEP_SUMMARY
          echo "Value: \`revanced\`" >> $GITHUB_STEP_SUMMARY
